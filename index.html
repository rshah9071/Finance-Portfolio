
       <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Financial Calculator Suite</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
    <style>
        /* ===== MAIN STYLES ===== */
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: #f8fafc;
            color: #1e293b;
        }
        .calculator-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            padding: 30px;
            margin-bottom: 20px;
        }
        h1, h2 {
            color: #1e40af;
            text-align: center;
        }
        .input-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #334155;
        }
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
        }
        button {
            background: #2563eb;
            color: white;
            border: none;
            padding: 14px;
            width: 100%;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 0;
            transition: background 0.3s;
        }
        button:hover {
            background: #1d4ed8;
        }
        .result {
            padding: 15px;
            background: #f1f5f9;
            border-radius: 8px;
            margin: 20px 0;
        }
        .result-value {
            font-weight: 600;
            color: #1e40af;
        }
        .calculator-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .calculator-nav button {
            flex: 1;
        }
        #roiChart, #amortChart {
            margin-top: 20px;
            max-height: 300px;
        }
        @media print {
            button, .calculator-nav { display: none; }
            body { padding: 0; background: white; }
        }
    </style>
</head>
<body>
    <div class="calculator-nav">
        <button onclick="showCalculator('loan')">Loan Calculator</button>
        <button onclick="showCalculator('roi')">ROI Calculator</button>
    </div>

    <!-- ===== LOAN CALCULATOR ===== -->
    <div id="loan-calculator" class="calculator-card">
        <h1>Loan Calculator</h1>
        
        <div class="input-group">
            <label>Loan Amount ($)</label>
            <input type="number" id="amount" value="100000">
        </div>
        
        <div class="input-group">
            <label>Interest Rate (%)</label>
            <input type="number" id="rate" value="5.5" step="0.01">
        </div>
        
        <div class="input-group">
            <label>Loan Term (Years)</label>
            <input type="number" id="years" value="15">
        </div>
        
        <button onclick="calculateLoan()">Calculate Payment</button>
        <button onclick="window.print()" style="background:#4b5563;">Print Report</button>
        
        <div class="result">
            <div><strong>Monthly Payment:</strong> <span id="monthly-payment" class="result-value">$0.00</span></div>
            <div><strong>Total Interest:</strong> <span id="total-interest" class="result-value">$0.00</span></div>
            <div><strong>Total Cost:</strong> <span id="total-cost" class="result-value">$0.00</span></div>
        </div>
        
        <canvas id="amortChart"></canvas>
    </div>

    <!-- ===== ROI CALCULATOR ===== -->
    <div id="roi-calculator" class="calculator-card" style="display:none;">
        <h1>Investment ROI Calculator</h1>
        
        <div class="input-group">
            <label>Initial Investment ($)</label>
            <input type="number" id="initial-investment" value="50000">
        </div>
        
        <div class="input-group">
            <label>Final Value ($)</label>
            <input type="number" id="final-value" value="75000">
        </div>
        
        <div class="input-group">
            <label>Investment Period (Years)</label>
            <input type="number" id="investment-period" value="5">
        </div>
        
        <button onclick="calculateROI()">Calculate ROI</button>
        <button onclick="exportROIData()" style="background:#059669;">Export to Excel</button>
        
        <div class="result">
            <div><strong>ROI:</strong> <span id="roi-percentage" class="result-value">0%</span></div>
            <div><strong>Annualized Return:</strong> <span id="annualized-return" class="result-value">0%</span></div>
            <div><strong>Profit/Loss:</strong> <span id="profit-loss" class="result-value">$0</span></div>
        </div>
        
        <canvas id="roiChart"></canvas>
    </div>

    <script>
        // ===== GLOBAL VARIABLES =====
        let loanChart, roiChart;

        // ===== LOAN CALCULATOR =====
        function calculateLoan() {
            const amount = parseFloat(document.getElementById('amount').value);
            const rate = parseFloat(document.getElementById('rate').value);
            const years = parseFloat(document.getElementById('years').value);
            
            if (isNaN(amount) || isNaN(rate) || isNaN(years)) {
                alert("Please enter valid numbers");
                return;
            }
            
            const monthlyRate = rate / 100 / 12;
            const payments = years * 12;
            const monthly = (amount * monthlyRate) / (1 - Math.pow(1 + monthlyRate, -payments));
            const totalInterest = monthly * payments - amount;
            
            document.getElementById('monthly-payment').textContent = formatCurrency(monthly);
            document.getElementById('total-interest').textContent = formatCurrency(totalInterest);
            document.getElementById('total-cost').textContent = formatCurrency(amount + totalInterest);
            
            renderAmortizationChart(amount, rate, years, monthly);
        }

        // ===== ROI CALCULATOR =====
        function calculateROI() {
            const initial = parseFloat(document.getElementById('initial-investment').value);
            const final = parseFloat(document.getElementById('final-value').value);
            const years = parseFloat(document.getElementById('investment-period').value);
            
            if (isNaN(initial) || isNaN(final) || isNaN(years)) {
                alert("Please enter valid numbers");
                return;
            }
            
            const profit = final - initial;
            const roi = (profit / initial) * 100;
            const annualized = ((final / initial) ** (1/years) - 1) * 100;
            
            document.getElementById('roi-percentage').textContent = roi.toFixed(2) + "%";
            document.getElementById('annualized-return').textContent = annualized.toFixed(2) + "%";
            document.getElementById('profit-loss').textContent = 
                profit >= 0 ? "+$" + profit.toFixed(2) : "-$" + Math.abs(profit).toFixed(2);
            
            renderROIChart(initial, final);
        }

        // ===== CHART FUNCTIONS =====
        function renderAmortizationChart(amount, rate, years, monthly) {
            const ctx = document.getElementById('amortChart').getContext('2d');
            const labels = Array.from({length: years}, (_, i) => `Year ${i+1}`);
            const principalData = [];
            const interestData = [];
            
            let balance = amount;
            const monthlyRate = rate / 100 / 12;
            
            for (let year = 1; year <= years; year++) {
                let yearlyPrincipal = 0;
                let yearlyInterest = 0;
                
                for (let month = 1; month <= 12; month++) {
                    const interest = balance * monthlyRate;
                    const principal = monthly - interest;
                    yearlyPrincipal += principal;
                    yearlyInterest += interest;
                    balance -= principal;
                }
                
                principalData.push(yearlyPrincipal);
                interestData.push(yearlyInterest);
            }
            
            if (window.loanChart) loanChart.destroy();
            
            window.loanChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Principal Paid',
                            data: principalData,
                            backgroundColor: 'rgba(54, 162, 235, 0.7)'
                        },
                        {
                            label: 'Interest Paid',
                            data: interestData,
                            backgroundColor: 'rgba(255, 99, 132, 0.7)'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: { stacked: true },
                        y: { 
                            stacked: true,
                            title: { display: true, text: 'Amount ($)' }
                        }
                    }
                }
            });
        }

        function renderROIChart(initial, final) {
            const ctx = document.getElementById('roiChart').getContext('2d');
            
            if (window.roiChart) window.roiChart.destroy();
            
            window.roiChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Initial Investment', 'Profit'],
                    datasets: [{
                        data: [initial, final - initial],
                        backgroundColor: [
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(75, 192, 192, 0.7)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + formatCurrency(context.raw);
                                }
                            }
                        }
                    }
                }
            });
        }

        // ===== UTILITY FUNCTIONS =====
        function formatCurrency(num) {
            return '$' + num.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
        }

        function showCalculator(type) {
            document.getElementById('loan-calculator').style.display = type === 'loan' ? 'block' : 'none';
            document.getElementById('roi-calculator').style.display = type === 'roi' ? 'block' : 'none';
        }

        function exportROIData() {
            const initial = parseFloat(document.getElementById('initial-investment').value);
            const final = parseFloat(document.getElementById('final-value').value);
            const years = parseFloat(document.getElementById('investment-period').value);
            const profit = final - initial;
            
            const data = [
                ['Metric', 'Value'],
                ['Initial Investment', formatCurrency(initial)],
                ['Final Value', formatCurrency(final)],
                ['Investment Period', years + ' years'],
                ['Profit/Loss', profit >= 0 ? '+'+formatCurrency(profit) : formatCurrency(profit)],
                ['ROI', ((profit/initial)*100).toFixed(2)+'%'],
                ['Annualized Return', ((Math.pow(final/initial,1/years)-1)*100).toFixed(2)+'%']
            ];
            
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(data);
            XLSX.utils.book_append_sheet(wb, ws, "ROI Analysis");
            XLSX.writeFile(wb, "ROI_Report.xlsx");
        }

        // Initialize
        window.onload = function() {
            calculateLoan();
            showCalculator('loan');
        };
    </script>
</body>
</html>
            
